# Comparing `tmp/metricq-5.0.2-py3-none-any.whl.zip` & `tmp/metricq-5.1.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,38 +1,38 @@
-Zip file size: 71951 bytes, number of entries: 36
--rw-r--r--  2.0 unx     2680 b- defN 23-Jun-05 07:35 metricq/__init__.py
--rw-r--r--  2.0 unx      124 b- defN 23-Jun-05 07:36 metricq/_protobuf_version.py
--rw-r--r--  2.0 unx    31111 b- defN 23-Jun-05 07:35 metricq/agent.py
--rw-r--r--  2.0 unx     9409 b- defN 23-Jun-05 07:35 metricq/client.py
--rw-r--r--  2.0 unx     4990 b- defN 23-Jun-05 07:35 metricq/connection_watchdog.py
--rw-r--r--  2.0 unx     5945 b- defN 23-Jun-05 07:35 metricq/data_client.py
--rw-r--r--  2.0 unx     2394 b- defN 23-Jun-05 07:36 metricq/datachunk_pb2.py
--rw-r--r--  2.0 unx     2776 b- defN 23-Jun-05 07:36 metricq/datachunk_pb2.pyi
--rw-r--r--  2.0 unx     4600 b- defN 23-Jun-05 07:35 metricq/drain.py
--rw-r--r--  2.0 unx     3716 b- defN 23-Jun-05 07:35 metricq/exceptions.py
--rw-r--r--  2.0 unx    31510 b- defN 23-Jun-05 07:35 metricq/history_client.py
--rw-r--r--  2.0 unx    13343 b- defN 23-Jun-05 07:36 metricq/history_pb2.py
--rw-r--r--  2.0 unx     7949 b- defN 23-Jun-05 07:36 metricq/history_pb2.pyi
--rw-r--r--  2.0 unx     7514 b- defN 23-Jun-05 07:35 metricq/interval_source.py
--rw-r--r--  2.0 unx     1272 b- defN 23-Jun-05 07:35 metricq/logging.py
--rw-r--r--  2.0 unx        0 b- defN 23-Jun-05 07:35 metricq/py.typed
--rw-r--r--  2.0 unx     5606 b- defN 23-Jun-05 07:35 metricq/rpc.py
--rw-r--r--  2.0 unx     9718 b- defN 23-Jun-05 07:35 metricq/sink.py
--rw-r--r--  2.0 unx    10746 b- defN 23-Jun-05 07:35 metricq/source.py
--rw-r--r--  2.0 unx     4173 b- defN 23-Jun-05 07:35 metricq/source_metric.py
--rw-r--r--  2.0 unx     4660 b- defN 23-Jun-05 07:35 metricq/subscription.py
--rw-r--r--  2.0 unx     7261 b- defN 23-Jun-05 07:35 metricq/synchronous_source.py
--rw-r--r--  2.0 unx     1700 b- defN 23-Jun-05 07:35 metricq/version.py
--rw-r--r--  2.0 unx       90 b- defN 23-Jun-05 07:35 metricq/pandas/__init__.py
--rw-r--r--  2.0 unx     4463 b- defN 23-Jun-05 07:35 metricq/pandas/pandas_history_client.py
--rw-r--r--  2.0 unx      330 b- defN 23-Jun-05 07:35 metricq/timeseries/__init__.py
--rw-r--r--  2.0 unx      253 b- defN 23-Jun-05 07:35 metricq/timeseries/extras.py
--rw-r--r--  2.0 unx     5060 b- defN 23-Jun-05 07:35 metricq/timeseries/time_aggregate.py
--rw-r--r--  2.0 unx     1103 b- defN 23-Jun-05 07:35 metricq/timeseries/time_value.py
--rw-r--r--  2.0 unx    15354 b- defN 23-Jun-05 07:35 metricq/timeseries/timedelta.py
--rw-r--r--  2.0 unx     8467 b- defN 23-Jun-05 07:35 metricq/timeseries/timestamp.py
--rw-r--r--  2.0 unx     1559 b- defN 23-Jun-05 07:36 metricq-5.0.2.dist-info/LICENSE
--rw-r--r--  2.0 unx     6904 b- defN 23-Jun-05 07:36 metricq-5.0.2.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Jun-05 07:36 metricq-5.0.2.dist-info/WHEEL
--rw-r--r--  2.0 unx        8 b- defN 23-Jun-05 07:36 metricq-5.0.2.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     2890 b- defN 23-Jun-05 07:36 metricq-5.0.2.dist-info/RECORD
-36 files, 219770 bytes uncompressed, 67393 bytes compressed:  69.3%
+Zip file size: 72186 bytes, number of entries: 36
+-rw-r--r--  2.0 unx     2680 b- defN 23-Jun-08 15:48 metricq/__init__.py
+-rw-r--r--  2.0 unx      124 b- defN 23-Jun-08 15:48 metricq/_protobuf_version.py
+-rw-r--r--  2.0 unx    31111 b- defN 23-Jun-08 15:48 metricq/agent.py
+-rw-r--r--  2.0 unx     9409 b- defN 23-Jun-08 15:48 metricq/client.py
+-rw-r--r--  2.0 unx     4990 b- defN 23-Jun-08 15:48 metricq/connection_watchdog.py
+-rw-r--r--  2.0 unx     5945 b- defN 23-Jun-08 15:48 metricq/data_client.py
+-rw-r--r--  2.0 unx     2394 b- defN 23-Jun-08 15:48 metricq/datachunk_pb2.py
+-rw-r--r--  2.0 unx     2776 b- defN 23-Jun-08 15:48 metricq/datachunk_pb2.pyi
+-rw-r--r--  2.0 unx     4600 b- defN 23-Jun-08 15:48 metricq/drain.py
+-rw-r--r--  2.0 unx     3716 b- defN 23-Jun-08 15:48 metricq/exceptions.py
+-rw-r--r--  2.0 unx    31510 b- defN 23-Jun-08 15:48 metricq/history_client.py
+-rw-r--r--  2.0 unx    13343 b- defN 23-Jun-08 15:48 metricq/history_pb2.py
+-rw-r--r--  2.0 unx     7949 b- defN 23-Jun-08 15:48 metricq/history_pb2.pyi
+-rw-r--r--  2.0 unx     7514 b- defN 23-Jun-08 15:48 metricq/interval_source.py
+-rw-r--r--  2.0 unx     1272 b- defN 23-Jun-08 15:48 metricq/logging.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-08 15:48 metricq/py.typed
+-rw-r--r--  2.0 unx     5606 b- defN 23-Jun-08 15:48 metricq/rpc.py
+-rw-r--r--  2.0 unx     9718 b- defN 23-Jun-08 15:48 metricq/sink.py
+-rw-r--r--  2.0 unx    10746 b- defN 23-Jun-08 15:48 metricq/source.py
+-rw-r--r--  2.0 unx     4173 b- defN 23-Jun-08 15:48 metricq/source_metric.py
+-rw-r--r--  2.0 unx     5462 b- defN 23-Jun-08 15:48 metricq/subscription.py
+-rw-r--r--  2.0 unx     7261 b- defN 23-Jun-08 15:48 metricq/synchronous_source.py
+-rw-r--r--  2.0 unx     1700 b- defN 23-Jun-08 15:48 metricq/version.py
+-rw-r--r--  2.0 unx       90 b- defN 23-Jun-08 15:48 metricq/pandas/__init__.py
+-rw-r--r--  2.0 unx     4463 b- defN 23-Jun-08 15:48 metricq/pandas/pandas_history_client.py
+-rw-r--r--  2.0 unx      330 b- defN 23-Jun-08 15:48 metricq/timeseries/__init__.py
+-rw-r--r--  2.0 unx      253 b- defN 23-Jun-08 15:48 metricq/timeseries/extras.py
+-rw-r--r--  2.0 unx     5060 b- defN 23-Jun-08 15:48 metricq/timeseries/time_aggregate.py
+-rw-r--r--  2.0 unx     1103 b- defN 23-Jun-08 15:48 metricq/timeseries/time_value.py
+-rw-r--r--  2.0 unx    15354 b- defN 23-Jun-08 15:48 metricq/timeseries/timedelta.py
+-rw-r--r--  2.0 unx     8467 b- defN 23-Jun-08 15:48 metricq/timeseries/timestamp.py
+-rw-r--r--  2.0 unx     1559 b- defN 23-Jun-08 15:48 metricq-5.1.0.dist-info/LICENSE
+-rw-r--r--  2.0 unx     6904 b- defN 23-Jun-08 15:48 metricq-5.1.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jun-08 15:48 metricq-5.1.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx        8 b- defN 23-Jun-08 15:48 metricq-5.1.0.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     2890 b- defN 23-Jun-08 15:48 metricq-5.1.0.dist-info/RECORD
+36 files, 220572 bytes uncompressed, 67628 bytes compressed:  69.3%
```

## zipnote {}

```diff
@@ -87,23 +87,23 @@
 
 Filename: metricq/timeseries/timedelta.py
 Comment: 
 
 Filename: metricq/timeseries/timestamp.py
 Comment: 
 
-Filename: metricq-5.0.2.dist-info/LICENSE
+Filename: metricq-5.1.0.dist-info/LICENSE
 Comment: 
 
-Filename: metricq-5.0.2.dist-info/METADATA
+Filename: metricq-5.1.0.dist-info/METADATA
 Comment: 
 
-Filename: metricq-5.0.2.dist-info/WHEEL
+Filename: metricq-5.1.0.dist-info/WHEEL
 Comment: 
 
-Filename: metricq-5.0.2.dist-info/top_level.txt
+Filename: metricq-5.1.0.dist-info/top_level.txt
 Comment: 
 
-Filename: metricq-5.0.2.dist-info/RECORD
+Filename: metricq-5.1.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## metricq/_protobuf_version.py

```diff
@@ -1,3 +1,3 @@
-# file generated on 2023-06-05 07:36:10.268854
+# file generated on 2023-06-08 15:48:29.890670
 _protobuf_version = "3.12.4"
 _protobuf_requirement = "protobuf>=3.12, <3.13"
```

## metricq/subscription.py

```diff
@@ -21,22 +21,22 @@
 # CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 # EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 # PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 # PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 # LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-from collections.abc import Iterable
+from collections.abc import AsyncIterator, Iterable
 from types import TracebackType
 from typing import Any, Optional
 
 from .client import Client
 from .drain import Drain
 from .logging import get_logger
-from .timeseries import Timedelta
+from .timeseries import JsonDict, Timedelta, Timestamp
 
 logger = get_logger(__name__)
 
 
 class Subscriber(Client):
     def __init__(
         self,
@@ -69,14 +69,19 @@
         self._kwargs = kwargs
 
         self.queue: Optional[str] = None
         """The name of the queue that is used to buffer the subscribed data
 
         This is only set after :meth:`.connect()` has finished.
         """
+        self.metadata: dict[str, JsonDict] = {}
+        """The metadata for the requested metrics
+
+        This is only filled after :meth:`.connect()` has finished.
+        """
 
     async def connect(self, **kwargs: Any) -> None:
         """Connects to the MetricQ network, sends the subscribe request, and disconnects again.
 
         After it has successfully finished, the :attr:`.queue` name is set.
 
         .. note::
@@ -89,36 +94,52 @@
 
         response = await self.rpc(
             "sink.subscribe", metrics=self._metrics, expires=self.expires.s, **kwargs
         )
 
         assert response is not None
         self.queue = response["dataQueue"]
+        assert isinstance(response["metrics"], dict)
+        self.metadata = response["metrics"]
         await self.stop()
 
     def drain(self, **kwargs: Any) -> Drain:
         """Returns a fully configured instance of a Drain, by using the given settings used for the subscription.
 
         As the Drain is a context manager, you should use the result of this in a `with`-statement::
 
             async with subscriber.drain() as data:
                 async for metric, time, value in data:
                     # ... process metric data
 
         Must only be called after :meth:`connect()` has finished successfully.
 
+        Note:
+            For a more convenient way to retrieve the data, see :meth:`collect_data()`.
+
         Returns:
             Drain: Fully configured instance of a Drain
         """
         assert self.queue is not None
 
         new_kwargs = self._kwargs
         new_kwargs.update(kwargs)
         return Drain(*self._args, **new_kwargs, queue=self.queue, metrics=self._metrics)
 
+    async def collect_data(
+        self, **kwargs: Any
+    ) -> AsyncIterator[tuple[str, Timestamp, float]]:
+        """
+        Asynchronously iterate over the retrieved data.
+        Can only be called once after :meth:`connect()` has finished successfully.
+        """
+        async with self.drain(**kwargs) as drain:
+            async for data in drain:
+                yield data
+
     async def __aexit__(
         self,
         exc_type: Optional[type[BaseException]],
         exc_value: Optional[BaseException],
         exc_traceback: Optional[TracebackType],
     ) -> None:
         # We don't need to `await self.stop()` here, as this is already done in `Subscriber.connect()`
```

## Comparing `metricq-5.0.2.dist-info/LICENSE` & `metricq-5.1.0.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `metricq-5.0.2.dist-info/METADATA` & `metricq-5.1.0.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: metricq
-Version: 5.0.2
+Version: 5.1.0
 Summary: A highly-scalable, distributed metric data processing framework based on RabbitMQ
 Home-page: https://github.com/metricq/metricq-python
 Author: TU Dresden
 License: BSD 3-clause "New" or "Revised License"
 Classifier: License :: OSI Approved :: BSD License
 Classifier: Programming Language :: Python :: 3
 Requires-Python: >=3.10
```

## Comparing `metricq-5.0.2.dist-info/RECORD` & `metricq-5.1.0.dist-info/RECORD`

 * *Files 8% similar despite different names*

```diff
@@ -1,9 +1,9 @@
 metricq/__init__.py,sha256=6kgzmmXhfX5Mb2TR77ALUrV3OKDJsp_K48PGPf8wQ20,2680
-metricq/_protobuf_version.py,sha256=O8IKQ-Vy5Pxfgj5DDDkCaY8l1pE2FKU9j0FgKB31ci0,124
+metricq/_protobuf_version.py,sha256=-NDQfWBxlCciUHd3KcFSeZsGeHGgA73zfAVGsakjQiI,124
 metricq/agent.py,sha256=VN1Qe7OcGYs0cpjEMdzY-NX9RgwdvclDEbJf3N67BoQ,31111
 metricq/client.py,sha256=4m9_wwy2DQ7Xx6eYMYunl_5u-2Ux_GfxLXcPGao3vQM,9409
 metricq/connection_watchdog.py,sha256=cv5gXbHlzHUlHqQbkeRnJ6yEsalt6Gi1Vb6_Z4rcOnY,4990
 metricq/data_client.py,sha256=OVW-iWzcQA-mww1NTbW5yMNnyli7_drcvFNAp6ck3ts,5945
 metricq/datachunk_pb2.py,sha256=pvFDu94IdU01_5amJf72gy6mK-ekGZmnrNlZ23lTBt8,2394
 metricq/datachunk_pb2.pyi,sha256=LWw976S7SJLKrUD1Doq-aZFxyf9a54cFVHQCo-vBRNc,2776
 metricq/drain.py,sha256=KcBqPwny8ztaMPlPzbDhzEHSNxxl0wL2Wf6gNWFnumg,4600
@@ -14,23 +14,23 @@
 metricq/interval_source.py,sha256=w2iNrDKEBxPzDzhVl0D1xNkzVowEh65s-W-mscUGoxQ,7514
 metricq/logging.py,sha256=FD9PMRmkq-DbVTjegKVOfknGwoFnipPlNnnaCxCSbII,1272
 metricq/py.typed,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 metricq/rpc.py,sha256=m_ucVGoahd_75vlWTQtnR0U0EHbr-b_S7CpQsZkkV7I,5606
 metricq/sink.py,sha256=71ApFNv97vLUBASEiXltov7OFF5ADiSYemBJHqVicqM,9718
 metricq/source.py,sha256=PnfXNffEV79kdr1RGM-QTfoyge3Dq0sfLWVQURptuV8,10746
 metricq/source_metric.py,sha256=XLmqts6Kt4F3vdmMzVpQvJ1RxhIeWzUGaxgJ4KJagTU,4173
-metricq/subscription.py,sha256=JcButJOYlZhaoAEL3LfGQFtATaEPug-I1mq6-PE_IbA,4660
+metricq/subscription.py,sha256=aNsulWGLj1-FWxmIIGGevd_m9HKb-TF6w2UNFMIUKJ4,5462
 metricq/synchronous_source.py,sha256=_JAw1B96Fr92wEqdEmQimC-iaBifA4cS74Adb-3RJCA,7261
 metricq/version.py,sha256=W-QgfeHfY0bcGOsGVYiT_FUI9C-cbnmtK9jjMSByqRY,1700
 metricq/pandas/__init__.py,sha256=t9fIMrdjz0GcsdgRFhHacxO3nor_fLg48FMYOexXP1Y,90
 metricq/pandas/pandas_history_client.py,sha256=YlxNOVL3QKQD8tjSvYpDkAvjapTQ6TLwxsfly9dyCxc,4463
 metricq/timeseries/__init__.py,sha256=toIY9gqliQNcwQLvgt8vuz0m1ng3siivR0P9QuicfNA,330
 metricq/timeseries/extras.py,sha256=6MOrfWEUJCP2DyqK-pUb04WYU8qEoO5p7EQDBhU67bE,253
 metricq/timeseries/time_aggregate.py,sha256=hGiexnzEGhX8IsVbHZdWa_d2u7IWkcOxy62i115_g34,5060
 metricq/timeseries/time_value.py,sha256=bcSZmvU4ANkjW40-Gf2_uLV8tWeOlMY56UlDQpCa4Eo,1103
 metricq/timeseries/timedelta.py,sha256=OosCnluEe0GTI63XzBpar53ytvq0HaICbcrf3Q6Y3ZA,15354
 metricq/timeseries/timestamp.py,sha256=sOzup0Uyyye2YJ0QvtoGSpzU1ozVZ3Uzbi1fpiYh-iI,8467
-metricq-5.0.2.dist-info/LICENSE,sha256=4h6-3O0i-fOl6I5GiEgQREkt1oGF13osLvN045KhVEQ,1559
-metricq-5.0.2.dist-info/METADATA,sha256=5CVW81dU6p8G9lcmGUzraMfxm_ZIxzUqgALjghfFs6w,6904
-metricq-5.0.2.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-metricq-5.0.2.dist-info/top_level.txt,sha256=NEFXKVj4euK5ANjLFlrVJ1pxZYZYmKfGfFw9S4nPKI0,8
-metricq-5.0.2.dist-info/RECORD,,
+metricq-5.1.0.dist-info/LICENSE,sha256=4h6-3O0i-fOl6I5GiEgQREkt1oGF13osLvN045KhVEQ,1559
+metricq-5.1.0.dist-info/METADATA,sha256=6vUKRr085lTPW5yFT6lVBiPxC-iJYnOL7IWyNsGpINY,6904
+metricq-5.1.0.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+metricq-5.1.0.dist-info/top_level.txt,sha256=NEFXKVj4euK5ANjLFlrVJ1pxZYZYmKfGfFw9S4nPKI0,8
+metricq-5.1.0.dist-info/RECORD,,
```

